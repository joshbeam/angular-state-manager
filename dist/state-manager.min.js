!function(t){"use strict";t.module("stateManager",[])}(angular),function(t){"use strict";function e(){function e(){return this.states=[],this.$scope={},t.forEach(arguments,function(t){this.states.push(new i(t))}.bind(this)),function(t){return t?this.states.filter(function(e){return e.$name===t})[0]:this}.bind(this)}function i(t){this.$name=t.name,this.$start=t.start||null,this.$stop=t.stop||null,this.$done=t.done||null,this.$subject=t.subject||{},this.$active=!1,this.$model="",this.$exclusiveOf=[],this.$children=[],this.$auxillary=t.auxillary||{},this.$scope={}}function n(){return this.states}function s(e){function i(e){return e?(this.$scope=e,void t.forEach(this.states,function(t){t.$scope=e})):this.$scope}function n(){var e=Array.prototype.slice.call(arguments);t.forEach(e,function(i){var n=this.states.filter(function(t){return t.$name===i})[0],s=e.filter(function(t){return t!==n.$name});t.forEach(s,function(t){n.$exclusiveOf.push(this.states.filter(function(e){return e.$name===t})[0])}.bind(this))}.bind(this))}function s(e){function i(t){return t.$name===s}function n(t){c=this.states.filter(function(e){return e.$name===t})[0],r.$children.push(c)}var s,r,c;for(s in e)r=this.states.filter(i)[0],o.children[s].constructor===Array?t.forEach(o.children[s],n.bind(this)):n(o.children[s])}var o,r,c=0;if(!e||e.constructor!==Function)throw new TypeError("Function object must be passed into StateGroup.prototype.config");o=e();for(var u in o)if("scope"!==u&&"exclusive"!==u&&"children"!==u)throw new SyntaxError(u+" cannot be set in .config()");"scope"in o&&i.call(this,o.scope),"exclusive"in o&&o.exclusive.constructor===Array&&(t.forEach(o.exclusive,function(t){t.constructor===Array?(r="array",c++):"string"==typeof t&&(r="string")}.bind(this)),c===o.exclusive.length&&"array"===r?t.forEach(o.exclusive,function(t){n.apply(this,t)}.bind(this)):"string"===r&&n.apply(this,o.exclusive)),"children"in o&&s.call(this,o.children)}function o(){var e=[];return t.forEach(this.states,function(t){e.push(t.$model)}),e}function r(t){return t in this?this[t]:void 0}function c(e){var i={},n={},s={},o={};if(e){if(i=e,"subject"in i){if("object"!=typeof i.subject)throw new TypeError(b.constants.errors.type.ILLEGAL_SUBJECT);n=i.subject}if("model"in i){if("string"!=typeof i.model)throw new TypeError('$model must be of type "string"');if(i.model.split(".").length<3)throw new SyntaxError(b.constants.errors.syntax.ILLEGAL_MODEL_STRING);s=i.model}"event"in i&&(o=i.event)}this.isActive()&&(this.model({}),this.stop());var r=null;return this.$active=!0,this.$subject=n,this.$model=s,s.constructor!==Object&&"string"==typeof s&&(r=b.getStringModelToModel(this,this.$scope,s)),t.forEach(this.$exclusiveOf,function(t){t.isActive()&&t.stop()}),t.forEach(this.$children,function(t){t.isActive()&&t.stop()}),null!==this.$start?this.$start(this.$subject,r,o):void 0}function u(t){var e;return t?("keepSubject"in t&&(this.$subject=t.keepSubject===!0?this.$subject:{}),"event"in t&&(e=t.event)):this.$subject={},""!==this.$model&&(this.model(""),this.$model=""),this.$active===!0&&(this.$active=!1),null!==this.$stop?this.$stop(e):void 0}function h(t){var e,i=!1,n=!1,s=!0;if(t){if("keepSubject"in t){if("boolean"!=typeof t.keepSubject)throw new TypeError("keepSubject "+b.constants.errors.type.ILLEGAL_CONFIG_BOOL);i=t.keepSubject}if("stop"in t){if("boolean"!=typeof t.stop)throw new TypeError("stop "+b.constants.errors.type.ILLEGAL_CONFIG_BOOL);s=t.stop}if("keepModel"in t){if("boolean"!=typeof t.keepModel)throw new TypeError("keepModel "+b.constants.errors.type.ILLEGAL_CONFIG_BOOL);n=t.keepModel}"event"in t&&(e=t.event)}var o=b.getStringModelToModel(this,this.$scope,this.$model);return null!==this.$done&&this.$done(this.$subject,o,e),n===!1&&this.model(""),s===!0&&this.stop({keepSubject:i,event:e}),this}function a(t){if(t)this.$subject=t;else if(!t)return this.$subject}function l(t){return t||""===t?"string"==typeof this.$model&&Object.keys(this.$scope).length>0?(b.setStringModelToModel(this.$scope,this.$model,t),!0):t?void 0:!1:this.$model}function f(){return this.$active}function p(){t.forEach(arguments,function(t){if(t.constructor!==Object)t in this.$auxillary&&this.$auxillary[t].call(this,this.$subject);else if(t.constructor===Object)for(var e in t)t[e].constructor!==Array&&(t[e]=[t[e]]),t[e].unshift(this.$subject),this.$auxillary[e].apply(this,t[e])}.bind(this))}function d(e,i,n){var s,o=!1;return"string"==typeof n&&(s=n.split("."),s.shift(),t.forEach(s,function(t){o=o?o[t]:i[t]}.bind(e))),o?o:!1}function $(t,e,i){var n,s,o=t;if("string"==typeof e){if(n=e.split("."),n.shift(),n.length<2)throw new SyntaxError(b.constants.errors.syntax.ILLEGAL_MODEL_STRING);for(var r=0;r<n.length;r++)0===r&&(o[n[0]]={},s=o[n[0]]),r>0&&r<n.length-1&&(s[n[r]]={},s=s[n[r]]),r===n.length-1&&(s[n[r]]=i)}}var y={StateGroup:e,State:i},b={getStringModelToModel:d,setStringModelToModel:$,constants:{errors:{syntax:{ILLEGAL_MODEL_STRING:"A model should be prefixed with [scope].models"},type:{ILLEGAL_SUBJECT:'A subject should be of type "object"',ILLEGAL_CONFIG_BOOL:"must contain a boolean value"}}}};return e.prototype={getAll:n,models:o,config:s},i.prototype={get:r,start:c,stop:u,done:h,subject:a,model:l,isActive:f,and:p},y}t.module("stateManager").factory("stateManager",e)}(angular);