!function(t){"use strict";t.module("stateManager",[])}(angular),function(t){"use strict";function e(){function e(){return this.states=[],this.$scope={},t.forEach(arguments,function(t){this.states.push(new i(t))}.bind(this)),function(t){return t?this.states.filter(function(e){return e.$name===t})[0]:this}.bind(this)}function i(t){this.$name=t.name,this.$start=t.start||null,this.$stop=t.stop||null,this.$done=t.done||null,this.$subject=t.subject||{},this.$active=!1,this.$model="",this.$exclusiveOf=[],this.$auxillary=t.auxillary||{},this.$scope={}}function s(){return this.states}function n(e){function i(e){return e?(this.$scope=e,void t.forEach(this.states,function(t){t.$scope=e})):this.$scope}function s(){var e=Array.prototype.slice.call(arguments);t.forEach(e,function(i){var s=this.states.filter(function(t){return t.$name===i})[0],n=e.filter(function(t){return t!==s.$name});t.forEach(n,function(t){s.$exclusiveOf.push(this.states.filter(function(e){return e.$name===t})[0])}.bind(this))}.bind(this))}var n,o,r=0;e&&e.constructor===Function&&(n=e(),"scope"in n&&i.call(this,n.scope),"exclusive"in n&&n.exclusive.constructor===Array&&(t.forEach(n.exclusive,function(t){t.constructor===Array?(o="array",r++):"string"==typeof t&&(o="string")}.bind(this)),r===n.exclusive.length&&"array"===o?t.forEach(n.exclusive,function(t){s.apply(this,t)}.bind(this)):"string"===o&&s.apply(this,n.exclusive)))}function o(){var e=[];return t.forEach(this.states,function(t){e.push(t.$model)}),e}function r(t){return t in this?this[t]:void 0}function c(e){var i={},s={},n={};e&&(i=e,"subject"in i&&(s=i.subject),"model"in i&&(n=i.model)),this.isActive()&&(this.model({}),this.stop());var o=null;return this.$active=!0,this.$subject=s,this.$model=n,n.constructor!==Object&&"string"==typeof n&&(o=v.getStringModelToModel(this,this.$scope,n)),t.forEach(this.$exclusiveOf,function(t){t.isActive()&&t.stop()}.bind(this)),null!==this.$start?this.$start(this.$subject,o):void 0}function u(t){return this.$active=!1,t&&"keepSubject"in t&&(this.$subject=t.keepSubject===!0?this.$subject:{}),this.model(""),this.$model="",null!==this.$stop?this.$stop():void 0}function a(t){var e=!1,i=!1,s=!0;if(t){if("keepSubject"in t){if("boolean"!=typeof t.keepSubject)throw new TypeError("keepSubject must contain a boolean value");e=t.keepSubject}if("stop"in t){if("boolean"!=typeof t.stop)throw new TypeError("stop must contain a boolean value");s=t.stop}if("keepModel"in t){if("boolean"!=typeof t.keepModel)throw new TypeError("keepModel must contain a boolean value");i=t.keepModel}}var n=v.getStringModelToModel(this,this.$scope,this.$model);return null!==this.$done&&this.$done(this.$subject,n),i===!1&&this.model(""),s===!0&&this.stop({keepSubject:e}),this}function h(t){if(t)this.$subject=t;else if(!t)return this.$subject}function l(t){return t||""===t?"string"==typeof this.$model&&Object.keys(this.$scope).length>0?(v.setStringModelToModel(this.$scope,this.$model,t),!0):t?void 0:!1:this.$model}function f(){return this.$active}function p(){t.forEach(arguments,function(t){if(t.constructor!==Object)t in this.$auxillary&&this.$auxillary[t].call(this,this.$subject);else if(t.constructor===Object)for(var e in t)t[e].constructor!==Array&&(t[e]=[t[e]]),t[e].unshift(this.$subject),this.$auxillary[e].apply(this,t[e])}.bind(this))}function d(e,i,s){var n,o=!1;return"string"==typeof s&&(n=s.split("."),n.shift(),t.forEach(n,function(t){o=o?o[t]:i[t]}.bind(e))),o?o:!1}function $(t,e,i){var s,n,o=t;if("string"==typeof e){if(s=e.split("."),s.shift(),s.length<2)throw new SyntaxError("A model should be prefixed with [scope].models");for(var r=0;r<s.length;r++)0===r&&(o[s[0]]={},n=o[s[0]]),r>0&&r<s.length-1&&(n[s[r]]={},n=n[s[r]]),r===s.length-1&&(n[s[r]]=i)}}var b={StateGroup:e,State:i},v={getStringModelToModel:d,setStringModelToModel:$};return e.prototype={getAll:s,models:o,config:n},i.prototype={get:r,start:c,stop:u,done:a,subject:h,model:l,isActive:f,and:p},b}t.module("stateManager").factory("stateManager",e)}(angular);